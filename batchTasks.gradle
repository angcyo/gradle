/**
 * 2023-2-11
 * 批量任务执行
 * 可以实现一键打包测试包/正式包/aab并上传apk文件到蒲公英
 * */

task _batchTasks(group: 'angcyo', description: '批量任务执行') {
    if (project.hasProperty("batchTasks")) {
        def tasks = getBatchTasks()
        dependsOn tasks
    }

    doFirst {
        if (project.hasProperty("batchTasks")) {
            System.err.println "准备执行批量任务:${getBatchTasks()}"
        } else {
            throw new IllegalStateException("请在[gradle.properties]文件中配置批量任务[batchTasks=xxx;xxx;xxx]")
        }
    }

    doLast {
        System.err.println "批量任务执行完成:${getBatchTasks()}"
    }
}

def getBatchTasks() {
    def tasks = project.ext.batchTasks
    return tasks.split(";")
}